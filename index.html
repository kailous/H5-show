<!DOCTYPE html>
<html>
${headHTML}

<body>
  <div id="fullpage"></div>
  <!-- 主页内容... -->
</body>
<script type="module">
  function generatePages(pages) {

    // 动态生成页面内容
    const fullpageContainer = document.getElementById('fullpage');

    // 生成页面内容
    Object.keys(pages).forEach(pageName => {
      const pageDiv = document.createElement('div');
      pageDiv.id = `page${pageName}Content`;
      pageDiv.className = 'pages section';
      pageDiv.innerHTML = pages[pageName];
      fullpageContainer.appendChild(pageDiv);
    });

    // 处理最后一个元素的类名
    const pageDivs = fullpageContainer.getElementsByClassName('pages section');
    if (pageDivs.length > 0) {
      const lastPageDiv = pageDivs[pageDivs.length - 1];
      lastPageDiv.className = 'pages section lastPage';
    }

    fetch('/lottiefiles')
  .then(response => response.json())
  .then(files => {
    files.forEach(fileName => {
      // 从文件名获取相应的 class 名称
      const className = fileName.replace('.json', '');
      const containers = document.querySelectorAll(`.lottie.${className}`);

      // 确保至少找到一个匹配的容器
      if (containers.length === 0) {
        console.error(`没有找到类名为 '${className}' 的 Lottie 容器`);
        return;
      }

      containers.forEach(container => {
        lottie.loadAnimation({
          container: container, // 动画容器
          renderer: 'svg',
          loop: true,
          autoplay: true,
          path: `/lottiefiles/${fileName}` // 动画文件路径
        });
      });
    });
  })
  .catch(err => console.error('无法加载 Lottie 文件:', err));


    // 确保fullpage.js初始化在页面内容加载之后
    new fullpage('#fullpage', {
      autoScrolling: true,
      scrollHorizontally: false
    });
  }
  // 从服务器获取页面内容
  fetch('/pages')
    .then(response => response.json())
    .then(pages => generatePages(pages))
    .catch(err => console.error('无法加载页面:', err));
</script>
</html>